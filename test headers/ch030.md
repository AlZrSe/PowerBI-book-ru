

Условный столбец (Conditional column)
=====================================

Мастер добавления столбца с условным значением (условного столбца),
формирует значение столбца согласно заданным правилам. Мастер добавления
условного столбца можно найти в Power Query, на вкладке добавления
столбца, как показано на скриншоте ниже.



![](media/file51.png)



Пояснения к мастеру конфигурации условного столбца показаны на скриншоте
ниже.



![](media/file52.png)



Для сведения - задаваемые условия в интерфейсе мастера пишут команду
скрипта содержащего операторы `if then else`. Это значит, что первым
будет проверено первое условие в мастере условного столбца. Все
множество значений будет проверено по этому условию. В случае, если
будут найдены результаты удовлетворяющие первому условию, то для них
будет присвоено значение по результатам выполнения первого условия. Для
остальных значений из множества, будет проверено следующее условие. И
так далее, до тех пор, пока не будут проверенны все условия. Если для
элементов множества не будет выполненно ни одно условие, то в условный
столбец попадет значение из поля "В противном случае / (otherwise)".

При создании условий важно помнить, операции сравнения включающие type
null и другие типы данных, возвращают ошибку в качестве результата.
Подробнее об этом можно прочитать [в блоге у Максима
Зеленского](http://excel-inside.pro/ru/blog/2018/05/17/%D1%81%D1%80%D0%B0%D0%B2%D0%BD%D0%B5%D0%BD%D0%B8%D0%B5-%D0%B7%D0%BD%D0%B0%D1%87%D0%B5%D0%BD%D0%B8%D0%B9-null-%D0%B2-power-query/)


